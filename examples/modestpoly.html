<html>
	<head>
		<title>HTMAPL: Polymaps or ModestMaps?</title>
		<script type="text/javascript" src="../lib/LAB.min.js"></script>
		<style type="text/css">@import url(style/examples.css);</style>
	</head>
	<body>

		<h1>HTMAPL: Polymaps <em>or</em> ModestMaps</h1>

		<p>Dynamically choose
		<a href="?render=poly">Polymaps</a> or
		<a href="?render=modest">ModestMaps</a> rendering!
		(or <a href="modestpoly.html">auto-detect</a>)
		</p>

		<div class="map narrow interact wheel" data-center="37.7639,-122.4130" data-zoom="12">
			<div class="layer" data-type="image"
				data-url="http://c.tile.cloudmade.com/1a1b06b230af4efdbb989ea99e9841af/998/256/{Z}/{X}/{Y}.png"></div>
			<div class="marker" data-location="37.7647463,-122.41951"><a href="http://stamen.com">Stamen</a></div>
		</div>

		<p>
		This script uses <a href="http://labjs.com/">LABjs</a> to sequentially
		load <a href="http://jquery.com/">jQuery</a> then <a
			href="http://www.modernizr.com/">Modernizr</a>.  If Modernizr detects SVG
		support we load <a href="http://polymaps.org/">Polymaps</a> and its minimal
		<a href="../src/polymaps-htmapl.js">HTMAPL strut</a>; otherwise, we grab
		<a href="https://github.com/stamen/modestmaps-js">ModestMaps</a> (which
		works in IE) and its new <a href="../src/modestmaps-htmapl.js">Polymaps-like strut</a>.
		</p>

		<script type="text/javascript">

			$LAB.setGlobalDefaults({
				AlwaysPreserveOrder: true
				// , UsePreloading: false
			});

			/**
			 * 1. Load jQuery and Modernizr first.
			 * 2. Check for SVG support, and load Polymaps if we have it; ModestMaps otherwise.
			 * 3. Do the stuff.
			 */
			$LAB
			.script("../lib/jquery-1.5.min.js")
			.script("../lib/modernizr.js")
			.wait(function() {
				var poly = Modernizr.svg && !window.location.search.match(/[\?&]render=modest/);
				$LAB
				.script(poly ? "../lib/polymaps.js" : "../lib/modestmaps.js")
				.script(poly ? "../src/polymaps-htmapl.js" : "../src/modestmaps-htmapl.js")
				.script("../src/htmapl.js")
				.wait(function() {
					$("div.map").htmapl();
				});

			});

		</script>

	</body>
</html>
